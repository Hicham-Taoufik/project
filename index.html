<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Information</title>
</head>
<body>
    <h1>Patient Information</h1>
    <p><strong>Name:</strong> <span id="name"></span></p>
    <p><strong>CIN:</strong> <span id="cin"></span></p>
    <p><strong>Address:</strong> <span id="address"></span></p>
    <p><strong>Date of Birth:</strong> <span id="dob"></span></p>

    <h2>Doctor's Notes</h2>
    <textarea id="doctorNotes" placeholder="Enter diagnosis or treatment here..."></textarea>
    <button onclick="submitNotes()">Submit Notes</button>

    <script>
        // Fetch Patient Data from n8n Webhook
        const urlParams = new URLSearchParams(window.location.search);
        const cin = urlParams.get("cin"); // Get CIN from the URL

        fetch(`https://your-n8n-instance.com/webhook-test/patient-info?cin=${cin}`)
            .then(response => response.json())
            .then(data => {
                document.getElementById("name").innerText = data.name || "N/A";
                document.getElementById("cin").innerText = data.cin || "N/A";
                document.getElementById("address").innerText = data.address || "N/A";
                document.getElementById("dob").innerText = data.dob || "N/A";
            });

        // Function to Send Doctor's Notes to n8n Webhook
        function submitNotes() {
            const doctorNotes = document.getElementById("doctorNotes").value;

            fetch("https://your-n8n-instance.com/webhook-test/save-notes", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    cin: cin,  // CIN of the patient
                    notes: doctorNotes
                })
            })
            .then(response => response.json())
            .then(data => alert("Notes saved successfully!"))
            .catch(error => alert("Error saving notes"));
        }
    </script>
</body>
</html>
